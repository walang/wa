(load "src/pa/test.wa")

; + --------------------------------------------------------------------------

(ok (is (+) 0))
(ok (is (+ 1 2 3) 6))
(ok (is (+ 1.0 1.1 1.2) 3.3))
(ok (is (+ 12 20/4) 17))
(ok (is (+ 12 20/7) 104/7))
(ok (is (+ 13 2.0) 15.0))
(ok (is (+ 1/10 1/15) 1/6))
(ok (is (+ "a" "b" 1) "ab1"))
(ok (is (+ "ab" "c" "de") "abcde"))
(ok (is (+ "ab" nil "c" "de" nil) "abcde"))
(ok (iso (+ '(a b) '(c d) '(e f)) '(a b c d e f)))
(ok (iso (+ '(a b) nil '(c d) nil '(e f)) '(a b c d e f)))

;cant-add-a-string-to-a-number (assert-error (+ 10 "11"))
;cant-add-a-number-to-a-list (assert-error (+ '(a b c) 4)))

; - --------------------------------------------------------------------------

(ok (is (- 25 7) 18))
(ok (is (- 1 2 3) -4))
(ok (is (- 1.2 3.4 5.6) -7.8))
(ok (is (- 12 20/4) 7))
(ok (is (- 1/10 1/15) 1/30))

; * --------------------------------------------------------------------------

(ok (is (*) 1))
(ok (is (* 23 7) 161))
(ok (is (* 2.5 3.5) 8.75))
(ok (is (* 5 1/2) 5/2))
(ok (is (* 2.5 7/2) 8.75))
(ok (is (* 7/2 2.5) 8.75))
(ok (is (* 9/4 4/3) 3))
(ok (is (* 1000000 4e-5) 40.0))
(ok (is (* 1000000 4.01e-5) 40.1))

; / --------------------------------------------------------------------------

(ok (is (/ 1 2) 1/2))
(ok (is (/ 1.0 2) 0.5))
(ok (is (/ 192 6) 32))
(ok (< (/ 11.2 3.5 3.200001) 3.19999))
(ok (is (/ 192 3 2) 32))
(ok (is (/ 30 2 2.5) 6.0))

; mod ------------------------------------------------------------------------

(ok (is (mod 10 3) 1))
(ok (is (mod -10 3) 2))
(ok (is (mod -21 5) 4))
(ok (is (mod -77/7 5) 4))

; expt -----------------------------------------------------------------------

(ok (is (expt 2.5 3) 15.625))
(ok (is (expt 100 0.5) 10.0))
(ok (is (expt 1000 0.5) 31.622776601683793))

; sqrt -----------------------------------------------------------------------

(ok (is (sqrt 16) 4))
(ok (is (sqrt 2) 1.4142135623730951))
(ok (is (sqrt 3.14) 1.772004514666935))
(ok (is (sqrt -1) #C(0.0 1.0)))

; sin ------------------------------------------------------------------------

(ok (is (sin 3.14) 0.001592548))

; cos ------------------------------------------------------------------------

(ok (is (cos 3.14) -0.9999987317275395))

; tan ------------------------------------------------------------------------

(ok (is (tan 3.14) -0.0015925501))

; asin -----------------------------------------------------------------------

(ok (is (asin 3.14) #C(1.5707964 -1.8109914)))

; acos -----------------------------------------------------------------------

(ok (is (acos 3.14) #C(0.0 1.8109914)))

; atan -----------------------------------------------------------------------

(ok (is (atan 3.14) 1.2624806))

; log ------------------------------------------------------------------------

(ok (is (log 100) 4.605170185988092))

; rand -----------------------------------------------------------------------

(ok (<= (rand 10) 10))
(ok (>= (rand 10) 0))
(ok (<= (rand) 1))
(ok (>= (rand) 0))

; trunc ----------------------------------------------------------------------

(ok (is (trunc 13.0) 13))
(ok (is (trunc 3.1415) 3))
(ok (is (trunc -1.1) -1))

; number ---------------------------------------------------------------------
; positive -------------------------------------------------------------------
; abs ------------------------------------------------------------------------
; round ----------------------------------------------------------------------
; roundup --------------------------------------------------------------------
; nearest --------------------------------------------------------------------
; median ---------------------------------------------------------------------
; med ------------------------------------------------------------------------
; avg ------------------------------------------------------------------------
; even -----------------------------------------------------------------------
; odd ------------------------------------------------------------------------
; max ------------------------------------------------------------------------
; min ------------------------------------------------------------------------
; multiple -------------------------------------------------------------------

(done-testing)
