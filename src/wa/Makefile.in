bindir = $(DESTDIR)@prefix@/bin
libdir = $(DESTDIR)@prefix@/lib

all: wa

wa: cf.lisp bi.wa.lisp wc.lisp wa.lisp
	@SBCL@ --noinform --no-sysinit --no-userinit --non-interactive --load wa.lisp

bi.wa.lisp: bi.wa
	@SBCL@ --noinform --no-sysinit --no-userinit --non-interactive --load wc.lisp --eval '(wa-compile "bi.wa" t)'

bi.wa: bi/*.wa
	cat bi/*.wa > bi.wa

clean:
	rm -f *.fasl *.wa.lisp bi.wa wa

install: wa
	mkdir -p $(bindir) $(libdir)/wa
	cp wa $(bindir)/wa

uninstall:
	rm -rf $(bindir)/wa $(libdir)/wa
